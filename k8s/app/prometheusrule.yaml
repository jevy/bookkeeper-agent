apiVersion: monitoring.coreos.com/v1
kind: PrometheusRule
metadata:
  name: tiller-consumer-alerts
  labels:
    app: tiller-categorizer
spec:
  groups:
    - name: tiller-consumer-group
      rules:
        - alert: TillerConsumerGroupMembersLow
          expr: redpanda_kafka_consumer_group_consumers{redpanda_group="categorizer-agent"} < 3
          for: 5m
          labels:
            severity: warning
          annotations:
            summary: "Categorizer consumer group has fewer than 3 members"
            description: "Consumer group categorizer-agent has {{ $value }} members (expected 3)"
        - alert: TillerConsumerGroupMembersLow
          expr: redpanda_kafka_consumer_group_consumers{redpanda_group="category-writer"} < 1
          for: 5m
          labels:
            severity: warning
          annotations:
            summary: "Writer consumer group has fewer than 1 member"
            description: "Consumer group category-writer has {{ $value }} members (expected 1)"
